# Database Setup Guide

Follow tutorial: https://www.youtube.com/watch?v=Gyh0c8pMmhE

---

## Step 1: Create Database Tables

Run these SQL commands in your Supabase SQL Editor:

### Create Items Table

```sql
CREATE TABLE public."Items" (
  name text NOT NULL DEFAULT ''::text,
  price bigint NOT NULL,
  barcode_id bigint NULL,
  active boolean NOT NULL DEFAULT true,
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  CONSTRAINT items_pkey PRIMARY KEY (id)
) TABLESPACE pg_default;
```

### Create Users Table

```sql
CREATE TABLE public."Users" (
  card_id bigint GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  name text NOT NULL DEFAULT ''::text,
  balance bigint NOT NULL DEFAULT '0'::bigint,
  active boolean NOT NULL DEFAULT true,
  CONSTRAINT Users_pkey PRIMARY KEY (card_id)
) TABLESPACE pg_default;
```

### Create Transaction History Table

```sql
CREATE TABLE public."Transaction_History" (
  "user" bigint NOT NULL,
  item uuid NOT NULL,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  CONSTRAINT Transaction_History_pkey PRIMARY KEY (id),
  CONSTRAINT Transaction_History_user_fkey FOREIGN KEY ("user") REFERENCES "Users" (card_id),
  CONSTRAINT transaction_history_item_fkey FOREIGN KEY (item) REFERENCES "Items" (id)
) TABLESPACE pg_default;
```

---

## Step 2: Add Example Data

### Insert Test Users

```sql
INSERT INTO "Users" (card_id, name, balance, active)
VALUES
  (1001, 'Alice Johnson', 5000, true),
  (1002, 'Bob Smith', 3500, true);
```

### Insert Test Items

```sql
INSERT INTO "Items" (name, price, barcode_id, active)
VALUES
  ('Coffee', 350, 12345, true),
  ('Sandwich', 650, 67890, true);
```

### Get Item UUIDs

Run this query to see the auto-generated UUIDs:

```sql
SELECT id, name FROM "Items";
```

**Copy the UUID values** - you'll need them for the next step!

---

## Step 3: Add Transaction Records

**Important:** Replace `'uuid-for-coffee'` and `'uuid-for-sandwich'` with the actual UUIDs from the previous query.

```sql
INSERT INTO "Transaction_History" ("user", item, created_at)
VALUES
  (1001, 'uuid-for-coffee'::uuid, NOW() - INTERVAL '2 days'),
  (1001, 'uuid-for-sandwich'::uuid, NOW() - INTERVAL '1 day'),
  (1002, 'uuid-for-coffee'::uuid, NOW() - INTERVAL '3 hours'),
  (1002, 'uuid-for-sandwich'::uuid, NOW() - INTERVAL '1 hour');
```

---

## Verify Your Data

Check that everything was created correctly:

```sql
-- View all users
SELECT * FROM "Users";

-- View all items
SELECT * FROM "Items";

-- View all transactions
SELECT * FROM "Transaction_History";
```

---

Your database is now set up with test data.
